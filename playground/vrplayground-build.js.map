{"version":3,"sources":["node_modules/browser-pack/_prelude.js","playground/objects/cube.js","playground/objects/testscene.js","playground/vrplayground.js","src/basegroup.js","src/plugins/tween.js","src/utils/color.js"],"names":[],"mappings":"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","file":"vrplayground-build.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import BaseGroup from '../../src/basegroup.js';\nimport Tween from '../../src/plugins/tween.js';\n\nexport default class Cube extends BaseGroup {\n    /**\n     * on create scene (or earliest possible opportunity)\n     * @param scene\n     */\n    onCreate() {\n        this._material = this.createMaterial();\n        var mesh = new THREE.Mesh(this.createGeometry(), this._material);\n        this.add(mesh, 'cube');\n        this.group.position.z = -20;\n        this.tweener = new Tween(this);\n\n        document.addEventListener('keyup', (event) => {\n            if (event.keyCode === 32) {\n                var props = {\n                    target: mesh,\n                    duration: 3000\n                };\n                this.tweener.animateColor( 0xff0000, 0x00ff00, props );\n                this.tweener.animatePosition( new THREE.Vector3(0,0,0), new THREE.Vector3(10,6,3), props );\n            }\n        });\n    }\n\n    /**\n     * on render\n     * @param time\n     */\n    onRender(time) {\n        this.group.rotation.y += .01;\n    }\n\n    /**\n     * create globe geometry\n     * @returns {THREE.IcosahedronGeometry}\n     */\n    createGeometry() {\n        return new THREE.CubeGeometry(5, 5, 5, 10, 10);\n    }\n\n    /**\n     * create globe material\n     */\n    createMaterial() {\n        return new THREE.MeshPhongMaterial({\n            color      :  0xff0000,\n            shininess  :  10,\n            shading    :  THREE.FlatShading,\n            transparent: true,\n            opacity    : 1\n        });\n    }\n}\n","import BaseGroup from '../../src/basegroup.js';\nimport Tween from '../../src/plugins/tween.js';\n\nexport default class TestScene extends BaseGroup {\n    /**\n     * on create scene (or earliest possible opportunity)\n     */\n    onCreate() {\n    }\n\n    onJSONSceneLoaded(scene) {\n        super.onJSONSceneLoaded(scene);\n        this._cube = scene.getObjectByName('Box 1');\n        this._sphere = scene.getObjectByName('Sphere 2');\n    };\n\n    /**\n     * on render\n     * @param time\n     */\n    onRender(time) {\n    }\n}\n","import Cube from './objects/cube.js';\nimport TestScene from './objects/testscene.js';\n\nexport default class VRPlaygroundScene {\n    constructor(scene) {\n        scene.onPreRender = this.render;\n\n        scene.addObjects([\n            new Cube(),\n            new TestScene({ scene: './assets/testscene.json' }),\n        ]);\n    }\n\n    render(time) {\n    }\n}\n","export default class BaseGroup {\n    constructor(params) {\n\n        /**\n         * parent group of child objects we will create\n         * @type {THREE.Object3D}\n         * @private\n         */\n        this._group = new THREE.Object3D();\n\n        /** additional render hooks we can add */\n        this._renderHooks = [];\n\n        this._config = params;\n        this.onInitialize(params);\n    }\n\n    /**\n     * get name of group\n     */\n    get name() {\n        return this.constructor.name;\n    }\n\n    /**\n     * overridable methods\n     * leave empty to be a simple abstraction we don't have to call super on\n     * @param scene\n     */\n    onCreate(scene) {};\n    onRender(scene, time) {};\n    onInitialize(params) {};\n    onAssetsLoaded(geometry, material) {};\n    onJSONSceneLoadProgress(progress) {};\n    onJSONSceneLoadError(err) {};\n    onJSONSceneLoaded(scene) { this.add(scene) };\n\n    /**\n     * on create scene (or earliest possible opportunity)\n     * @param scene\n     */\n    create(scene) {\n        this._group.name = this.name;\n        this._sceneCollection = scene;\n        scene.scene.add(this._group);\n\n        if (this._config && this._config.assets) {\n            // todo: determine when to use JSON Loader, OBJ loader, or whatever\n            var loader = new THREE.JSONLoader();\n            loader.load(this._config.assets, (geometry, materials) => {\n                this.onAssetsLoaded(geometry, materials);\n            });\n        }\n\n        if (this._config && this._config.scene) {\n            // todo: determine when to use JSON Loader, OBJ loader, or whatever\n            var loader = new THREE.ObjectLoader();\n            loader.load(this._config.scene, (loaded) => {\n                this.onJSONSceneLoaded(loaded);\n            }, (progress) => {\n                this.onJSONSceneLoadProgress(progress);\n            }, (err) => {\n                this.onJSONSceneLoadError(err);\n            });\n        }\n\n        this.onCreate();\n    }\n\n    /**\n     * add object to scene\n     * @param object\n     */\n    add(object, name) {\n        if (!name) {\n            name = this.name + '-child';\n        }\n        object.name = name;\n        this._group.add(object);\n    }\n\n    addRenderHook(method) {\n        this._renderHooks.push(method);\n    }\n\n    /**\n     * get parent group object\n     * @returns {THREE.Object3D}\n     */\n    get group() {\n        return this._group;\n    }\n\n    /**\n     * get scene\n     * @returns {THREE.Object3D}\n     */\n    get sceneCollection() {\n        return this._sceneCollection;\n    }\n\n    /**\n     * get children of this group\n     * @returns {Array}\n     */\n    get children() {\n        return this._group.children;\n    }\n\n    /**\n     * on prerender scene\n     * @param scene\n     */\n    preRender() {}\n\n    /**\n     * on render scene\n     * @param time\n     */\n    render(time) {\n        for (var c = 0; c < this._renderHooks.length; c++) {\n            this._renderHooks[c].apply(this, [time]);\n        }\n        this.onRender(time);\n    }\n}\n","import Color from '../utils/color.js';\n\nexport default class Tween {\n    constructor(group) {\n        if (!createjs) {\n            throw new Error('CreateJS Tween must be included in your build or linked via script to animate');\n            return;\n        }\n        group.addRenderHook( (scene, time) => this.onRender(scene, time));\n        this.animations = [];\n    }\n\n    /**\n     * animate THREE.js mesh position property\n     * @param {int} from\n     * @param {int} to\n     * @param options\n     */\n    animateColor(from, to, options) {\n        if (typeof from !== 'object') {\n            if (typeof from !== 'number' && from.charAt(0) === '#') {\n                from = Number('0x' + from.substr(1, from.length));\n                from = Color.decToRGB(from);\n            } else {\n                from = Color.decToRGB(from);\n            }\n        }\n\n        if (typeof to !== 'object') {\n            if (typeof to !== 'number' && to.charAt(0) === '#') {\n                to = Number('0x' + to.substr(1, to.length));\n                to = Color.decToRGB(to);\n            } else {\n                to = Color.decToRGB(to);\n            }\n        }\n\n        from = this.populateStartAnimationObject(from, options);\n        from.animation.step.push( (step) => this.animateColorStep(step));\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * animate THREE.js mesh position property\n     * @param {Three.js Vector3} from\n     * @param {Three.js Vector3} to\n     * @param options\n     */\n    animatePosition(from, to, options) {\n        from = { x: from.x, y: from.y, z: from.z };\n        to = { x: to.x, y: to.y, z: to.z };\n        from = this.populateStartAnimationObject(from, options);\n        from.animation.step.push( (step) => this.animatePositionStep(step));\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * create and start animation\n     * @param from\n     * @param to\n     * @param options\n     */\n    animate(from, to, options) {\n        if (!createjs) {\n            throw new Error('CreateJS Tween must be included in your build or linked via script to animate');\n            return;\n        }\n\n        if (!options.step) {\n            throw new Error('Please define a \"step\" property on options to specify a callback for each animation update');\n        }\n\n        from = this.populateStartAnimationObject(from, to);\n        this.createTween(to, from, options);\n        this.animations.push(from);\n    }\n\n    /**\n     * populate animation start object\n     * @param from\n     * @param options\n     * @returns {*}\n     */\n    populateStartAnimationObject(from, options) {\n        from.animation = {};\n        from.animation.animating = true;\n        from.animation.step = [];\n        if (options.step) {\n            from.animation.step.push(options.step);\n        }\n        from.animation.target = options.target;\n        from.animation.loop = options.loop;\n        from.animation.complete = options.complete;\n        return from;\n    }\n\n    /**\n     * create tween\n     * @param to\n     * @param from\n     * @param options\n     * @returns {Tween}\n     */\n    createTween(to, from, options) {\n        createjs.Tween.get(from, options)\n            .to(to, options.duration)\n            .call( function() {\n                if (!this._loop) {\n                    this.animation.animating = false;\n                }\n                if (this.animation.complete) {\n                    this.animation.complete.apply(this, [this]);\n                }\n            });\n    }\n\n    /**\n     * animate step for Three.JS position\n     * @param step\n     */\n    animatePositionStep(step) {\n        step.animation.target.position.set(step.x, step.y, step.z);\n    }\n\n    /**\n     * animate step for Three.JS material color\n     * @param step\n     */\n    animateColorStep(step) {\n        step.animation.target.material.color.setRGB(step.r/255, step.g/255, step.b/255);\n    }\n\n    /**\n     * animate render hook\n     * @param time\n     * @param scene\n     */\n    onRender(scene, time) {\n        var running = [];\n        for (var c = 0; c < this.animations.length; c++) {\n            if (this.animations[c].animation.animating) {\n                running.push(this.animations[c]);\n                for (var d = 0; d < this.animations[c].animation.step.length; d++) {\n                    this.animations[c].animation.step[d].apply(this, [this.animations[c]]);\n                }\n            }\n        }\n        this.animations = running;\n    }\n}\n","export default {\n    /**\n     * turn decimal color to RGB\n     * @param dec\n     * @returns {{r: number, g: number, b: number}}\n     */\n    decToRGB(dec) {\n        var r = (dec >> 16) & 0xff;\n        var g = (dec >> 8)  & 0xff;\n        var b = dec & 0xff;\n        return { r: r, g: g, b: b };\n    },\n\n    RGBToDec(rgb) {\n        return rgb.r << 16 + rgb.g << 16 + rgb.b;\n    }\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwbGF5Z3JvdW5kL29iamVjdHMvY3ViZS5qcyIsInBsYXlncm91bmQvb2JqZWN0cy90ZXN0c2NlbmUuanMiLCJwbGF5Z3JvdW5kL3ZycGxheWdyb3VuZC5qcyIsInNyYy9iYXNlZ3JvdXAuanMiLCJzcmMvcGx1Z2lucy90d2Vlbi5qcyIsInNyYy91dGlscy9jb2xvci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0FBOzs7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0ksQUFFcUI7Ozs7Ozs7Ozs7YUFDakI7Ozs7OzttQ0FJVzt5QkFDUDs7aUJBQUEsQUFBSyxZQUFZLEtBQWpCLEFBQWlCLEFBQUssQUFDdEI7Z0JBQUksT0FBTyxJQUFJLE1BQUosQUFBVSxLQUFLLEtBQWYsQUFBZSxBQUFLLGtCQUFrQixLQUFqRCxBQUFXLEFBQTJDLEFBQ3REO2lCQUFBLEFBQUssSUFBTCxBQUFTLE1BQVQsQUFBZSxBQUNmO2lCQUFBLEFBQUssTUFBTCxBQUFXLFNBQVgsQUFBb0IsSUFBSSxDQUF4QixBQUF5QixBQUN6QjtpQkFBQSxBQUFLLFVBQVUsb0JBQWYsQUFBZSxBQUFVLEFBRXpCOztxQkFBQSxBQUFTLGlCQUFULEFBQTBCLFNBQVMsVUFBQSxBQUFDLE9BQVUsQUFDMUM7b0JBQUksTUFBQSxBQUFNLFlBQVYsQUFBc0IsSUFBSSxBQUN0Qjt3QkFBSTtnQ0FBUSxBQUNBLEFBQ1I7a0NBRkosQUFBWSxBQUVFLEFBRWQ7QUFKWSxBQUNSOzJCQUdKLEFBQUssUUFBTCxBQUFhLGFBQWIsQUFBMkIsVUFBM0IsQUFBcUMsVUFBckMsQUFBK0MsQUFDL0M7MkJBQUEsQUFBSyxRQUFMLEFBQWEsZ0JBQWlCLElBQUksTUFBSixBQUFVLFFBQVYsQUFBa0IsR0FBbEIsQUFBb0IsR0FBbEQsQUFBOEIsQUFBc0IsSUFBSSxJQUFJLE1BQUosQUFBVSxRQUFWLEFBQWtCLElBQWxCLEFBQXFCLEdBQTdFLEFBQXdELEFBQXVCLElBQS9FLEFBQW1GLEFBQ3RGO0FBQ0o7QUFURCxBQVVIO0FBRUQ7Ozs7Ozs7OztpQyxBQUlTLE1BQU0sQUFDWDtpQkFBQSxBQUFLLE1BQUwsQUFBVyxTQUFYLEFBQW9CLEtBQXBCLEFBQXlCLEFBQzVCO0FBRUQ7Ozs7Ozs7Ozt5Q0FJaUIsQUFDYjttQkFBTyxJQUFJLE1BQUosQUFBVSxhQUFWLEFBQXVCLEdBQXZCLEFBQTBCLEdBQTFCLEFBQTZCLEdBQTdCLEFBQWdDLElBQXZDLEFBQU8sQUFBb0MsQUFDOUM7QUFFRDs7Ozs7Ozs7eUNBR2lCLEFBQ2I7dUJBQVcsTUFBSixBQUFVO3VCQUFrQixBQUNqQixBQUNkOzJCQUYrQixBQUVqQixBQUNkO3lCQUFjLE1BSGlCLEFBR1gsQUFDcEI7NkJBSitCLEFBSWxCLEFBQ2I7eUJBTEosQUFBTyxBQUE0QixBQUtsQixBQUVwQjtBQVBzQyxBQUMvQixhQURHOzs7Ozs7O2tCLEFBNUNNOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSHJCOzs7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0ksQUFFcUI7Ozs7Ozs7Ozs7U0FDakI7Ozs7OytCQUdXLEFBQ1Y7OztzQyxBQUVpQixPQUFPLEFBQ3JCOzhIQUFBLEFBQXdCLEFBQ3hCO1dBQUEsQUFBSyxRQUFRLE1BQUEsQUFBTSxnQkFBbkIsQUFBYSxBQUFzQixBQUNuQztXQUFBLEFBQUssVUFBVSxNQUFBLEFBQU0sZ0JBQXJCLEFBQWUsQUFBc0IsQUFDeEM7OztTQUVEOzs7Ozs7NkIsQUFJUyxNQUFNLEFBQ2Q7Ozs7OztrQixBQWxCZ0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNIckI7Ozs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7SSxBQUVxQixnQ0FDakI7K0JBQUEsQUFBWSxPQUFPOzhCQUNmOztjQUFBLEFBQU0sY0FBYyxLQUFwQixBQUF5QixBQUV6Qjs7Y0FBQSxBQUFNLFdBQVcsQ0FDYixXQURhLFdBRWIsd0JBQWMsRUFBRSxPQUZwQixBQUFpQixBQUViLEFBQWMsQUFBUyxBQUU5Qjs7Ozs7K0IsQUFFTSxNQUFNLEFBQ1o7Ozs7OztrQixBQVhnQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJLEFDSEEsd0JBQ2pCO3VCQUFBLEFBQVksUUFBUTs4QkFFaEI7O0FBS0E7Ozs7O2FBQUEsQUFBSyxTQUFTLElBQUksTUFBbEIsQUFBYyxBQUFVLEFBRXhCOztBQUNBO2FBQUEsQUFBSyxlQUFMLEFBQW9CLEFBRXBCOzthQUFBLEFBQUssVUFBTCxBQUFlLEFBQ2Y7YUFBQSxBQUFLLGFBQUwsQUFBa0IsQUFDckI7QUFFRDs7Ozs7OzthQU9BOzs7Ozs7O2lDLEFBS1MsT0FBTyxBQUFFOzs7aUMsQUFDVCxPLEFBQU8sTUFBTSxBQUFFOzs7cUMsQUFDWCxRQUFRLEFBQUU7Ozt1QyxBQUNSLFUsQUFBVSxVQUFVLEFBQUU7OztnRCxBQUNiLFVBQVUsQUFBRTs7OzZDLEFBQ2YsS0FBSyxBQUFFOzs7MEMsQUFDVixPQUFPLEFBQUU7aUJBQUEsQUFBSyxJQUFMLEFBQVMsQUFBUTs7O2FBRTVDOzs7Ozs7K0IsQUFJTyxPQUFPO3dCQUNWOztpQkFBQSxBQUFLLE9BQUwsQUFBWSxPQUFPLEtBQW5CLEFBQXdCLEFBQ3hCO2lCQUFBLEFBQUssbUJBQUwsQUFBd0IsQUFDeEI7a0JBQUEsQUFBTSxNQUFOLEFBQVksSUFBSSxLQUFoQixBQUFxQixBQUVyQjs7Z0JBQUksS0FBQSxBQUFLLFdBQVcsS0FBQSxBQUFLLFFBQXpCLEFBQWlDLFFBQVEsQUFDckM7QUFDQTtvQkFBSSxTQUFTLElBQUksTUFBakIsQUFBYSxBQUFVLEFBQ3ZCO3VCQUFBLEFBQU8sS0FBSyxLQUFBLEFBQUssUUFBakIsQUFBeUIsUUFBUSxVQUFBLEFBQUMsVUFBRCxBQUFXLFdBQWMsQUFDdEQ7MEJBQUEsQUFBSyxlQUFMLEFBQW9CLFVBQXBCLEFBQThCLEFBQ2pDO0FBRkQsQUFHSDtBQUVEOztnQkFBSSxLQUFBLEFBQUssV0FBVyxLQUFBLEFBQUssUUFBekIsQUFBaUMsT0FBTyxBQUNwQztBQUNBO29CQUFJLFNBQVMsSUFBSSxNQUFqQixBQUFhLEFBQVUsQUFDdkI7dUJBQUEsQUFBTyxLQUFLLEtBQUEsQUFBSyxRQUFqQixBQUF5QixPQUFPLFVBQUEsQUFBQyxRQUFXLEFBQ3hDOzBCQUFBLEFBQUssa0JBQUwsQUFBdUIsQUFDMUI7QUFGRCxtQkFFRyxVQUFBLEFBQUMsVUFBYSxBQUNiOzBCQUFBLEFBQUssd0JBQUwsQUFBNkIsQUFDaEM7QUFKRCxtQkFJRyxVQUFBLEFBQUMsS0FBUSxBQUNSOzBCQUFBLEFBQUsscUJBQUwsQUFBMEIsQUFDN0I7QUFORCxBQU9IO0FBRUQ7O2lCQUFBLEFBQUssQUFDUjtBQUVEOzs7Ozs7Ozs7NEIsQUFJSSxRLEFBQVEsTUFBTSxBQUNkO2dCQUFJLENBQUosQUFBSyxNQUFNLEFBQ1A7dUJBQU8sS0FBQSxBQUFLLE9BQVosQUFBbUIsQUFDdEI7QUFDRDttQkFBQSxBQUFPLE9BQVAsQUFBYyxBQUNkO2lCQUFBLEFBQUssT0FBTCxBQUFZLElBQVosQUFBZ0IsQUFDbkI7Ozs7c0MsQUFFYSxRQUFRLEFBQ2xCO2lCQUFBLEFBQUssYUFBTCxBQUFrQixLQUFsQixBQUF1QixBQUMxQjtBQUVEOzs7Ozs7OzthQXdCQTs7Ozs7O29DQUlZLEFBQUUsQ0FFZDs7Ozs7Ozs7OytCLEFBSU8sTUFBTSxBQUNUO2lCQUFLLElBQUksSUFBVCxBQUFhLEdBQUcsSUFBSSxLQUFBLEFBQUssYUFBekIsQUFBc0MsUUFBdEMsQUFBOEMsS0FBSyxBQUMvQztxQkFBQSxBQUFLLGFBQUwsQUFBa0IsR0FBbEIsQUFBcUIsTUFBckIsQUFBMkIsTUFBTSxDQUFqQyxBQUFpQyxBQUFDLEFBQ3JDO0FBQ0Q7aUJBQUEsQUFBSyxTQUFMLEFBQWMsQUFDakI7Ozs7NEJBeEdVLEFBQ1A7bUJBQU8sS0FBQSxBQUFLLFlBQVosQUFBd0IsQUFDM0I7Ozs7NEJBbUVXLEFBQ1I7bUJBQU8sS0FBUCxBQUFZLEFBQ2Y7QUFFRDs7Ozs7Ozs7OzRCQUlzQixBQUNsQjttQkFBTyxLQUFQLEFBQVksQUFDZjtBQUVEOzs7Ozs7Ozs7NEJBSWUsQUFDWDttQkFBTyxLQUFBLEFBQUssT0FBWixBQUFtQixBQUN0Qjs7Ozs7OztrQixBQTNHZ0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0FyQjs7Ozs7Ozs7Ozs7Ozs7SSxBQUVxQixvQkFDakI7bUJBQUEsQUFBWSxPQUFPO29CQUFBOzs4QkFDZjs7WUFBSSxDQUFKLEFBQUssVUFBVSxBQUNYO2tCQUFNLElBQUEsQUFBSSxNQUFWLEFBQU0sQUFBVSxBQUNoQjtBQUNIO0FBQ0Q7Y0FBQSxBQUFNLGNBQWUsVUFBQSxBQUFDLE9BQUQsQUFBUSxNQUFSO21CQUFpQixNQUFBLEFBQUssU0FBTCxBQUFjLE9BQS9CLEFBQWlCLEFBQXFCO0FBQTNELEFBQ0E7YUFBQSxBQUFLLGFBQUwsQUFBa0IsQUFDckI7QUFFRDs7Ozs7Ozs7Ozs7cUMsQUFNYSxNLEFBQU0sSSxBQUFJLFNBQVM7eUJBQzVCOztnQkFBSSxRQUFBLEFBQU8sNkNBQVAsQUFBTyxXQUFYLEFBQW9CLFVBQVUsQUFDMUI7b0JBQUksT0FBQSxBQUFPLFNBQVAsQUFBZ0IsWUFBWSxLQUFBLEFBQUssT0FBTCxBQUFZLE9BQTVDLEFBQW1ELEtBQUssQUFDcEQ7MkJBQU8sT0FBTyxPQUFPLEtBQUEsQUFBSyxPQUFMLEFBQVksR0FBRyxLQUFwQyxBQUFPLEFBQWMsQUFBb0IsQUFDekM7MkJBQU8sZ0JBQUEsQUFBTSxTQUFiLEFBQU8sQUFBZSxBQUN6QjtBQUhELHVCQUdPLEFBQ0g7MkJBQU8sZ0JBQUEsQUFBTSxTQUFiLEFBQU8sQUFBZSxBQUN6QjtBQUNKO0FBRUQ7O2dCQUFJLFFBQUEsQUFBTywyQ0FBUCxBQUFPLFNBQVgsQUFBa0IsVUFBVSxBQUN4QjtvQkFBSSxPQUFBLEFBQU8sT0FBUCxBQUFjLFlBQVksR0FBQSxBQUFHLE9BQUgsQUFBVSxPQUF4QyxBQUErQyxLQUFLLEFBQ2hEO3lCQUFLLE9BQU8sT0FBTyxHQUFBLEFBQUcsT0FBSCxBQUFVLEdBQUcsR0FBaEMsQUFBSyxBQUFjLEFBQWdCLEFBQ25DO3lCQUFLLGdCQUFBLEFBQU0sU0FBWCxBQUFLLEFBQWUsQUFDdkI7QUFIRCx1QkFHTyxBQUNIO3lCQUFLLGdCQUFBLEFBQU0sU0FBWCxBQUFLLEFBQWUsQUFDdkI7QUFDSjtBQUVEOzttQkFBTyxLQUFBLEFBQUssNkJBQUwsQUFBa0MsTUFBekMsQUFBTyxBQUF3QyxBQUMvQztpQkFBQSxBQUFLLFVBQUwsQUFBZSxLQUFmLEFBQW9CLEtBQU0sVUFBQSxBQUFDLE1BQUQ7dUJBQVUsT0FBQSxBQUFLLGlCQUFmLEFBQVUsQUFBc0I7QUFBMUQsQUFDQTtpQkFBQSxBQUFLLFlBQUwsQUFBaUIsSUFBakIsQUFBcUIsTUFBckIsQUFBMkIsQUFDM0I7aUJBQUEsQUFBSyxXQUFMLEFBQWdCLEtBQWhCLEFBQXFCLEFBQ3hCO0FBRUQ7Ozs7Ozs7Ozs7O3dDLEFBTWdCLE0sQUFBTSxJLEFBQUksU0FBUzt5QkFDL0I7O21CQUFPLEVBQUUsR0FBRyxLQUFMLEFBQVUsR0FBRyxHQUFHLEtBQWhCLEFBQXFCLEdBQUcsR0FBRyxLQUFsQyxBQUFPLEFBQWdDLEFBQ3ZDO2lCQUFLLEVBQUUsR0FBRyxHQUFMLEFBQVEsR0FBRyxHQUFHLEdBQWQsQUFBaUIsR0FBRyxHQUFHLEdBQTVCLEFBQUssQUFBMEIsQUFDL0I7bUJBQU8sS0FBQSxBQUFLLDZCQUFMLEFBQWtDLE1BQXpDLEFBQU8sQUFBd0MsQUFDL0M7aUJBQUEsQUFBSyxVQUFMLEFBQWUsS0FBZixBQUFvQixLQUFNLFVBQUEsQUFBQyxNQUFEO3VCQUFVLE9BQUEsQUFBSyxvQkFBZixBQUFVLEFBQXlCO0FBQTdELEFBQ0E7aUJBQUEsQUFBSyxZQUFMLEFBQWlCLElBQWpCLEFBQXFCLE1BQXJCLEFBQTJCLEFBQzNCO2lCQUFBLEFBQUssV0FBTCxBQUFnQixLQUFoQixBQUFxQixBQUN4QjtBQUVEOzs7Ozs7Ozs7OztnQyxBQU1RLE0sQUFBTSxJLEFBQUksU0FBUyxBQUN2QjtnQkFBSSxDQUFKLEFBQUssVUFBVSxBQUNYO3NCQUFNLElBQUEsQUFBSSxNQUFWLEFBQU0sQUFBVSxBQUNoQjtBQUNIO0FBRUQ7O2dCQUFJLENBQUMsUUFBTCxBQUFhLE1BQU0sQUFDZjtzQkFBTSxJQUFBLEFBQUksTUFBVixBQUFNLEFBQVUsQUFDbkI7QUFFRDs7bUJBQU8sS0FBQSxBQUFLLDZCQUFMLEFBQWtDLE1BQXpDLEFBQU8sQUFBd0MsQUFDL0M7aUJBQUEsQUFBSyxZQUFMLEFBQWlCLElBQWpCLEFBQXFCLE1BQXJCLEFBQTJCLEFBQzNCO2lCQUFBLEFBQUssV0FBTCxBQUFnQixLQUFoQixBQUFxQixBQUN4QjtBQUVEOzs7Ozs7Ozs7OztxRCxBQU02QixNLEFBQU0sU0FBUyxBQUN4QztpQkFBQSxBQUFLLFlBQUwsQUFBaUIsQUFDakI7aUJBQUEsQUFBSyxVQUFMLEFBQWUsWUFBZixBQUEyQixBQUMzQjtpQkFBQSxBQUFLLFVBQUwsQUFBZSxPQUFmLEFBQXNCLEFBQ3RCO2dCQUFJLFFBQUosQUFBWSxNQUFNLEFBQ2Q7cUJBQUEsQUFBSyxVQUFMLEFBQWUsS0FBZixBQUFvQixLQUFLLFFBQXpCLEFBQWlDLEFBQ3BDO0FBQ0Q7aUJBQUEsQUFBSyxVQUFMLEFBQWUsU0FBUyxRQUF4QixBQUFnQyxBQUNoQztpQkFBQSxBQUFLLFVBQUwsQUFBZSxPQUFPLFFBQXRCLEFBQThCLEFBQzlCO2lCQUFBLEFBQUssVUFBTCxBQUFlLFdBQVcsUUFBMUIsQUFBa0MsQUFDbEM7bUJBQUEsQUFBTyxBQUNWO0FBRUQ7Ozs7Ozs7Ozs7OztvQyxBQU9ZLEksQUFBSSxNLEFBQU0sU0FBUyxBQUMzQjtxQkFBQSxBQUFTLE1BQVQsQUFBZSxJQUFmLEFBQW1CLE1BQW5CLEFBQXlCLFNBQXpCLEFBQ0ssR0FETCxBQUNRLElBQUksUUFEWixBQUNvQixVQURwQixBQUVLLEtBQU0sWUFBVyxBQUNkO29CQUFJLENBQUMsS0FBTCxBQUFVLE9BQU8sQUFDYjt5QkFBQSxBQUFLLFVBQUwsQUFBZSxZQUFmLEFBQTJCLEFBQzlCO0FBQ0Q7b0JBQUksS0FBQSxBQUFLLFVBQVQsQUFBbUIsVUFBVSxBQUN6Qjt5QkFBQSxBQUFLLFVBQUwsQUFBZSxTQUFmLEFBQXdCLE1BQXhCLEFBQThCLE1BQU0sQ0FBcEMsQUFBb0MsQUFBQyxBQUN4QztBQUNKO0FBVEwsQUFVSDtBQUVEOzs7Ozs7Ozs7NEMsQUFJb0IsTUFBTSxBQUN0QjtpQkFBQSxBQUFLLFVBQUwsQUFBZSxPQUFmLEFBQXNCLFNBQXRCLEFBQStCLElBQUksS0FBbkMsQUFBd0MsR0FBRyxLQUEzQyxBQUFnRCxHQUFHLEtBQW5ELEFBQXdELEFBQzNEO0FBRUQ7Ozs7Ozs7Ozt5QyxBQUlpQixNQUFNLEFBQ25CO2lCQUFBLEFBQUssVUFBTCxBQUFlLE9BQWYsQUFBc0IsU0FBdEIsQUFBK0IsTUFBL0IsQUFBcUMsT0FBTyxLQUFBLEFBQUssSUFBakQsQUFBbUQsS0FBSyxLQUFBLEFBQUssSUFBN0QsQUFBK0QsS0FBSyxLQUFBLEFBQUssSUFBekUsQUFBMkUsQUFDOUU7QUFFRDs7Ozs7Ozs7OztpQyxBQUtTLE8sQUFBTyxNQUFNLEFBQ2xCO2dCQUFJLFVBQUosQUFBYyxBQUNkO2lCQUFLLElBQUksSUFBVCxBQUFhLEdBQUcsSUFBSSxLQUFBLEFBQUssV0FBekIsQUFBb0MsUUFBcEMsQUFBNEMsS0FBSyxBQUM3QztvQkFBSSxLQUFBLEFBQUssV0FBTCxBQUFnQixHQUFoQixBQUFtQixVQUF2QixBQUFpQyxXQUFXLEFBQ3hDOzRCQUFBLEFBQVEsS0FBSyxLQUFBLEFBQUssV0FBbEIsQUFBYSxBQUFnQixBQUM3Qjt5QkFBSyxJQUFJLElBQVQsQUFBYSxHQUFHLElBQUksS0FBQSxBQUFLLFdBQUwsQUFBZ0IsR0FBaEIsQUFBbUIsVUFBbkIsQUFBNkIsS0FBakQsQUFBc0QsUUFBdEQsQUFBOEQsS0FBSyxBQUMvRDs2QkFBQSxBQUFLLFdBQUwsQUFBZ0IsR0FBaEIsQUFBbUIsVUFBbkIsQUFBNkIsS0FBN0IsQUFBa0MsR0FBbEMsQUFBcUMsTUFBckMsQUFBMkMsTUFBTSxDQUFDLEtBQUEsQUFBSyxXQUF2RCxBQUFpRCxBQUFDLEFBQWdCLEFBQ3JFO0FBQ0o7QUFDSjtBQUNEO2lCQUFBLEFBQUssYUFBTCxBQUFrQixBQUNyQjs7Ozs7OztrQixBQXBKZ0I7Ozs7Ozs7OztBQ0lqQjs7Ozs7QUFOVyxnQ0FBQSxBQU1GLEtBQUssQUFDVjtZQUFJLElBQUssT0FBRCxBQUFRLEtBQWhCLEFBQXNCLEFBQ3RCO1lBQUksSUFBSyxPQUFELEFBQVEsSUFBaEIsQUFBc0IsQUFDdEI7WUFBSSxJQUFJLE1BQVIsQUFBYyxBQUNkO2VBQU8sRUFBRSxHQUFGLEFBQUssR0FBRyxHQUFSLEFBQVcsR0FBRyxHQUFyQixBQUFPLEFBQWlCLEFBQzNCO0FBWFUsQUFhWDtBQWJXLGdDQUFBLEFBYUYsS0FBSyxBQUNWO2VBQU8sSUFBQSxBQUFJLEtBQUssS0FBSyxJQUFkLEFBQWtCLEtBQUssS0FBSyxJQUFuQyxBQUF1QyxBQUMxQztBLEFBZlU7QUFBQSxBQUNYIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBCYXNlR3JvdXAgZnJvbSAnLi4vLi4vc3JjL2Jhc2Vncm91cC5qcyc7XG5pbXBvcnQgVHdlZW4gZnJvbSAnLi4vLi4vc3JjL3BsdWdpbnMvdHdlZW4uanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdWJlIGV4dGVuZHMgQmFzZUdyb3VwIHtcbiAgICAvKipcbiAgICAgKiBvbiBjcmVhdGUgc2NlbmUgKG9yIGVhcmxpZXN0IHBvc3NpYmxlIG9wcG9ydHVuaXR5KVxuICAgICAqIEBwYXJhbSBzY2VuZVxuICAgICAqL1xuICAgIG9uQ3JlYXRlKCkge1xuICAgICAgICB0aGlzLl9tYXRlcmlhbCA9IHRoaXMuY3JlYXRlTWF0ZXJpYWwoKTtcbiAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmNyZWF0ZUdlb21ldHJ5KCksIHRoaXMuX21hdGVyaWFsKTtcbiAgICAgICAgdGhpcy5hZGQobWVzaCwgJ2N1YmUnKTtcbiAgICAgICAgdGhpcy5ncm91cC5wb3NpdGlvbi56ID0gLTIwO1xuICAgICAgICB0aGlzLnR3ZWVuZXIgPSBuZXcgVHdlZW4odGhpcyk7XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzMikge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBtZXNoLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy50d2VlbmVyLmFuaW1hdGVDb2xvciggMHhmZjAwMDAsIDB4MDBmZjAwLCBwcm9wcyApO1xuICAgICAgICAgICAgICAgIHRoaXMudHdlZW5lci5hbmltYXRlUG9zaXRpb24oIG5ldyBUSFJFRS5WZWN0b3IzKDAsMCwwKSwgbmV3IFRIUkVFLlZlY3RvcjMoMTAsNiwzKSwgcHJvcHMgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogb24gcmVuZGVyXG4gICAgICogQHBhcmFtIHRpbWVcbiAgICAgKi9cbiAgICBvblJlbmRlcih0aW1lKSB7XG4gICAgICAgIHRoaXMuZ3JvdXAucm90YXRpb24ueSArPSAuMDE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIGdsb2JlIGdlb21ldHJ5XG4gICAgICogQHJldHVybnMge1RIUkVFLkljb3NhaGVkcm9uR2VvbWV0cnl9XG4gICAgICovXG4gICAgY3JlYXRlR2VvbWV0cnkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVEhSRUUuQ3ViZUdlb21ldHJ5KDUsIDUsIDUsIDEwLCAxMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIGdsb2JlIG1hdGVyaWFsXG4gICAgICovXG4gICAgY3JlYXRlTWF0ZXJpYWwoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe1xuICAgICAgICAgICAgY29sb3IgICAgICA6ICAweGZmMDAwMCxcbiAgICAgICAgICAgIHNoaW5pbmVzcyAgOiAgMTAsXG4gICAgICAgICAgICBzaGFkaW5nICAgIDogIFRIUkVFLkZsYXRTaGFkaW5nLFxuICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICAgICAgICBvcGFjaXR5ICAgIDogMVxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQmFzZUdyb3VwIGZyb20gJy4uLy4uL3NyYy9iYXNlZ3JvdXAuanMnO1xuaW1wb3J0IFR3ZWVuIGZyb20gJy4uLy4uL3NyYy9wbHVnaW5zL3R3ZWVuLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVzdFNjZW5lIGV4dGVuZHMgQmFzZUdyb3VwIHtcbiAgICAvKipcbiAgICAgKiBvbiBjcmVhdGUgc2NlbmUgKG9yIGVhcmxpZXN0IHBvc3NpYmxlIG9wcG9ydHVuaXR5KVxuICAgICAqL1xuICAgIG9uQ3JlYXRlKCkge1xuICAgIH1cblxuICAgIG9uSlNPTlNjZW5lTG9hZGVkKHNjZW5lKSB7XG4gICAgICAgIHN1cGVyLm9uSlNPTlNjZW5lTG9hZGVkKHNjZW5lKTtcbiAgICAgICAgdGhpcy5fY3ViZSA9IHNjZW5lLmdldE9iamVjdEJ5TmFtZSgnQm94IDEnKTtcbiAgICAgICAgdGhpcy5fc3BoZXJlID0gc2NlbmUuZ2V0T2JqZWN0QnlOYW1lKCdTcGhlcmUgMicpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBvbiByZW5kZXJcbiAgICAgKiBAcGFyYW0gdGltZVxuICAgICAqL1xuICAgIG9uUmVuZGVyKHRpbWUpIHtcbiAgICB9XG59XG4iLCJpbXBvcnQgQ3ViZSBmcm9tICcuL29iamVjdHMvY3ViZS5qcyc7XG5pbXBvcnQgVGVzdFNjZW5lIGZyb20gJy4vb2JqZWN0cy90ZXN0c2NlbmUuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWUlBsYXlncm91bmRTY2VuZSB7XG4gICAgY29uc3RydWN0b3Ioc2NlbmUpIHtcbiAgICAgICAgc2NlbmUub25QcmVSZW5kZXIgPSB0aGlzLnJlbmRlcjtcblxuICAgICAgICBzY2VuZS5hZGRPYmplY3RzKFtcbiAgICAgICAgICAgIG5ldyBDdWJlKCksXG4gICAgICAgICAgICBuZXcgVGVzdFNjZW5lKHsgc2NlbmU6ICcuL2Fzc2V0cy90ZXN0c2NlbmUuanNvbicgfSksXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIHJlbmRlcih0aW1lKSB7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZUdyb3VwIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogcGFyZW50IGdyb3VwIG9mIGNoaWxkIG9iamVjdHMgd2Ugd2lsbCBjcmVhdGVcbiAgICAgICAgICogQHR5cGUge1RIUkVFLk9iamVjdDNEfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZ3JvdXAgPSBuZXcgVEhSRUUuT2JqZWN0M0QoKTtcblxuICAgICAgICAvKiogYWRkaXRpb25hbCByZW5kZXIgaG9va3Mgd2UgY2FuIGFkZCAqL1xuICAgICAgICB0aGlzLl9yZW5kZXJIb29rcyA9IFtdO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IHBhcmFtcztcbiAgICAgICAgdGhpcy5vbkluaXRpYWxpemUocGFyYW1zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBnZXQgbmFtZSBvZiBncm91cFxuICAgICAqL1xuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG92ZXJyaWRhYmxlIG1ldGhvZHNcbiAgICAgKiBsZWF2ZSBlbXB0eSB0byBiZSBhIHNpbXBsZSBhYnN0cmFjdGlvbiB3ZSBkb24ndCBoYXZlIHRvIGNhbGwgc3VwZXIgb25cbiAgICAgKiBAcGFyYW0gc2NlbmVcbiAgICAgKi9cbiAgICBvbkNyZWF0ZShzY2VuZSkge307XG4gICAgb25SZW5kZXIoc2NlbmUsIHRpbWUpIHt9O1xuICAgIG9uSW5pdGlhbGl6ZShwYXJhbXMpIHt9O1xuICAgIG9uQXNzZXRzTG9hZGVkKGdlb21ldHJ5LCBtYXRlcmlhbCkge307XG4gICAgb25KU09OU2NlbmVMb2FkUHJvZ3Jlc3MocHJvZ3Jlc3MpIHt9O1xuICAgIG9uSlNPTlNjZW5lTG9hZEVycm9yKGVycikge307XG4gICAgb25KU09OU2NlbmVMb2FkZWQoc2NlbmUpIHsgdGhpcy5hZGQoc2NlbmUpIH07XG5cbiAgICAvKipcbiAgICAgKiBvbiBjcmVhdGUgc2NlbmUgKG9yIGVhcmxpZXN0IHBvc3NpYmxlIG9wcG9ydHVuaXR5KVxuICAgICAqIEBwYXJhbSBzY2VuZVxuICAgICAqL1xuICAgIGNyZWF0ZShzY2VuZSkge1xuICAgICAgICB0aGlzLl9ncm91cC5uYW1lID0gdGhpcy5uYW1lO1xuICAgICAgICB0aGlzLl9zY2VuZUNvbGxlY3Rpb24gPSBzY2VuZTtcbiAgICAgICAgc2NlbmUuc2NlbmUuYWRkKHRoaXMuX2dyb3VwKTtcblxuICAgICAgICBpZiAodGhpcy5fY29uZmlnICYmIHRoaXMuX2NvbmZpZy5hc3NldHMpIHtcbiAgICAgICAgICAgIC8vIHRvZG86IGRldGVybWluZSB3aGVuIHRvIHVzZSBKU09OIExvYWRlciwgT0JKIGxvYWRlciwgb3Igd2hhdGV2ZXJcbiAgICAgICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuSlNPTkxvYWRlcigpO1xuICAgICAgICAgICAgbG9hZGVyLmxvYWQodGhpcy5fY29uZmlnLmFzc2V0cywgKGdlb21ldHJ5LCBtYXRlcmlhbHMpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQXNzZXRzTG9hZGVkKGdlb21ldHJ5LCBtYXRlcmlhbHMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fY29uZmlnICYmIHRoaXMuX2NvbmZpZy5zY2VuZSkge1xuICAgICAgICAgICAgLy8gdG9kbzogZGV0ZXJtaW5lIHdoZW4gdG8gdXNlIEpTT04gTG9hZGVyLCBPQkogbG9hZGVyLCBvciB3aGF0ZXZlclxuICAgICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PYmplY3RMb2FkZXIoKTtcbiAgICAgICAgICAgIGxvYWRlci5sb2FkKHRoaXMuX2NvbmZpZy5zY2VuZSwgKGxvYWRlZCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub25KU09OU2NlbmVMb2FkZWQobG9hZGVkKTtcbiAgICAgICAgICAgIH0sIChwcm9ncmVzcykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub25KU09OU2NlbmVMb2FkUHJvZ3Jlc3MocHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub25KU09OU2NlbmVMb2FkRXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5vbkNyZWF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFkZCBvYmplY3QgdG8gc2NlbmVcbiAgICAgKiBAcGFyYW0gb2JqZWN0XG4gICAgICovXG4gICAgYWRkKG9iamVjdCwgbmFtZSkge1xuICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLm5hbWUgKyAnLWNoaWxkJztcbiAgICAgICAgfVxuICAgICAgICBvYmplY3QubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2dyb3VwLmFkZChvYmplY3QpO1xuICAgIH1cblxuICAgIGFkZFJlbmRlckhvb2sobWV0aG9kKSB7XG4gICAgICAgIHRoaXMuX3JlbmRlckhvb2tzLnB1c2gobWV0aG9kKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBnZXQgcGFyZW50IGdyb3VwIG9iamVjdFxuICAgICAqIEByZXR1cm5zIHtUSFJFRS5PYmplY3QzRH1cbiAgICAgKi9cbiAgICBnZXQgZ3JvdXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ncm91cDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBnZXQgc2NlbmVcbiAgICAgKiBAcmV0dXJucyB7VEhSRUUuT2JqZWN0M0R9XG4gICAgICovXG4gICAgZ2V0IHNjZW5lQ29sbGVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjZW5lQ29sbGVjdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBnZXQgY2hpbGRyZW4gb2YgdGhpcyBncm91cFxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKi9cbiAgICBnZXQgY2hpbGRyZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ncm91cC5jaGlsZHJlbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBvbiBwcmVyZW5kZXIgc2NlbmVcbiAgICAgKiBAcGFyYW0gc2NlbmVcbiAgICAgKi9cbiAgICBwcmVSZW5kZXIoKSB7fVxuXG4gICAgLyoqXG4gICAgICogb24gcmVuZGVyIHNjZW5lXG4gICAgICogQHBhcmFtIHRpbWVcbiAgICAgKi9cbiAgICByZW5kZXIodGltZSkge1xuICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuX3JlbmRlckhvb2tzLmxlbmd0aDsgYysrKSB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJIb29rc1tjXS5hcHBseSh0aGlzLCBbdGltZV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25SZW5kZXIodGltZSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IENvbG9yIGZyb20gJy4uL3V0aWxzL2NvbG9yLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHdlZW4ge1xuICAgIGNvbnN0cnVjdG9yKGdyb3VwKSB7XG4gICAgICAgIGlmICghY3JlYXRlanMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlYXRlSlMgVHdlZW4gbXVzdCBiZSBpbmNsdWRlZCBpbiB5b3VyIGJ1aWxkIG9yIGxpbmtlZCB2aWEgc2NyaXB0IHRvIGFuaW1hdGUnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBncm91cC5hZGRSZW5kZXJIb29rKCAoc2NlbmUsIHRpbWUpID0+IHRoaXMub25SZW5kZXIoc2NlbmUsIHRpbWUpKTtcbiAgICAgICAgdGhpcy5hbmltYXRpb25zID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYW5pbWF0ZSBUSFJFRS5qcyBtZXNoIHBvc2l0aW9uIHByb3BlcnR5XG4gICAgICogQHBhcmFtIHtpbnR9IGZyb21cbiAgICAgKiBAcGFyYW0ge2ludH0gdG9cbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGFuaW1hdGVDb2xvcihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgICAgICBpZiAodHlwZW9mIGZyb20gIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGZyb20gIT09ICdudW1iZXInICYmIGZyb20uY2hhckF0KDApID09PSAnIycpIHtcbiAgICAgICAgICAgICAgICBmcm9tID0gTnVtYmVyKCcweCcgKyBmcm9tLnN1YnN0cigxLCBmcm9tLmxlbmd0aCkpO1xuICAgICAgICAgICAgICAgIGZyb20gPSBDb2xvci5kZWNUb1JHQihmcm9tKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZnJvbSA9IENvbG9yLmRlY1RvUkdCKGZyb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiB0byAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdG8gIT09ICdudW1iZXInICYmIHRvLmNoYXJBdCgwKSA9PT0gJyMnKSB7XG4gICAgICAgICAgICAgICAgdG8gPSBOdW1iZXIoJzB4JyArIHRvLnN1YnN0cigxLCB0by5sZW5ndGgpKTtcbiAgICAgICAgICAgICAgICB0byA9IENvbG9yLmRlY1RvUkdCKHRvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdG8gPSBDb2xvci5kZWNUb1JHQih0byk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmcm9tID0gdGhpcy5wb3B1bGF0ZVN0YXJ0QW5pbWF0aW9uT2JqZWN0KGZyb20sIG9wdGlvbnMpO1xuICAgICAgICBmcm9tLmFuaW1hdGlvbi5zdGVwLnB1c2goIChzdGVwKSA9PiB0aGlzLmFuaW1hdGVDb2xvclN0ZXAoc3RlcCkpO1xuICAgICAgICB0aGlzLmNyZWF0ZVR3ZWVuKHRvLCBmcm9tLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5hbmltYXRpb25zLnB1c2goZnJvbSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYW5pbWF0ZSBUSFJFRS5qcyBtZXNoIHBvc2l0aW9uIHByb3BlcnR5XG4gICAgICogQHBhcmFtIHtUaHJlZS5qcyBWZWN0b3IzfSBmcm9tXG4gICAgICogQHBhcmFtIHtUaHJlZS5qcyBWZWN0b3IzfSB0b1xuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICovXG4gICAgYW5pbWF0ZVBvc2l0aW9uKGZyb20sIHRvLCBvcHRpb25zKSB7XG4gICAgICAgIGZyb20gPSB7IHg6IGZyb20ueCwgeTogZnJvbS55LCB6OiBmcm9tLnogfTtcbiAgICAgICAgdG8gPSB7IHg6IHRvLngsIHk6IHRvLnksIHo6IHRvLnogfTtcbiAgICAgICAgZnJvbSA9IHRoaXMucG9wdWxhdGVTdGFydEFuaW1hdGlvbk9iamVjdChmcm9tLCBvcHRpb25zKTtcbiAgICAgICAgZnJvbS5hbmltYXRpb24uc3RlcC5wdXNoKCAoc3RlcCkgPT4gdGhpcy5hbmltYXRlUG9zaXRpb25TdGVwKHN0ZXApKTtcbiAgICAgICAgdGhpcy5jcmVhdGVUd2Vlbih0bywgZnJvbSwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucy5wdXNoKGZyb20pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNyZWF0ZSBhbmQgc3RhcnQgYW5pbWF0aW9uXG4gICAgICogQHBhcmFtIGZyb21cbiAgICAgKiBAcGFyYW0gdG9cbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGFuaW1hdGUoZnJvbSwgdG8sIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFjcmVhdGVqcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVhdGVKUyBUd2VlbiBtdXN0IGJlIGluY2x1ZGVkIGluIHlvdXIgYnVpbGQgb3IgbGlua2VkIHZpYSBzY3JpcHQgdG8gYW5pbWF0ZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFvcHRpb25zLnN0ZXApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGRlZmluZSBhIFwic3RlcFwiIHByb3BlcnR5IG9uIG9wdGlvbnMgdG8gc3BlY2lmeSBhIGNhbGxiYWNrIGZvciBlYWNoIGFuaW1hdGlvbiB1cGRhdGUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZyb20gPSB0aGlzLnBvcHVsYXRlU3RhcnRBbmltYXRpb25PYmplY3QoZnJvbSwgdG8pO1xuICAgICAgICB0aGlzLmNyZWF0ZVR3ZWVuKHRvLCBmcm9tLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5hbmltYXRpb25zLnB1c2goZnJvbSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcG9wdWxhdGUgYW5pbWF0aW9uIHN0YXJ0IG9iamVjdFxuICAgICAqIEBwYXJhbSBmcm9tXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBwb3B1bGF0ZVN0YXJ0QW5pbWF0aW9uT2JqZWN0KGZyb20sIG9wdGlvbnMpIHtcbiAgICAgICAgZnJvbS5hbmltYXRpb24gPSB7fTtcbiAgICAgICAgZnJvbS5hbmltYXRpb24uYW5pbWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgZnJvbS5hbmltYXRpb24uc3RlcCA9IFtdO1xuICAgICAgICBpZiAob3B0aW9ucy5zdGVwKSB7XG4gICAgICAgICAgICBmcm9tLmFuaW1hdGlvbi5zdGVwLnB1c2gob3B0aW9ucy5zdGVwKTtcbiAgICAgICAgfVxuICAgICAgICBmcm9tLmFuaW1hdGlvbi50YXJnZXQgPSBvcHRpb25zLnRhcmdldDtcbiAgICAgICAgZnJvbS5hbmltYXRpb24ubG9vcCA9IG9wdGlvbnMubG9vcDtcbiAgICAgICAgZnJvbS5hbmltYXRpb24uY29tcGxldGUgPSBvcHRpb25zLmNvbXBsZXRlO1xuICAgICAgICByZXR1cm4gZnJvbTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjcmVhdGUgdHdlZW5cbiAgICAgKiBAcGFyYW0gdG9cbiAgICAgKiBAcGFyYW0gZnJvbVxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybnMge1R3ZWVufVxuICAgICAqL1xuICAgIGNyZWF0ZVR3ZWVuKHRvLCBmcm9tLCBvcHRpb25zKSB7XG4gICAgICAgIGNyZWF0ZWpzLlR3ZWVuLmdldChmcm9tLCBvcHRpb25zKVxuICAgICAgICAgICAgLnRvKHRvLCBvcHRpb25zLmR1cmF0aW9uKVxuICAgICAgICAgICAgLmNhbGwoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fbG9vcCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbi5hbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uLmNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uLmNvbXBsZXRlLmFwcGx5KHRoaXMsIFt0aGlzXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYW5pbWF0ZSBzdGVwIGZvciBUaHJlZS5KUyBwb3NpdGlvblxuICAgICAqIEBwYXJhbSBzdGVwXG4gICAgICovXG4gICAgYW5pbWF0ZVBvc2l0aW9uU3RlcChzdGVwKSB7XG4gICAgICAgIHN0ZXAuYW5pbWF0aW9uLnRhcmdldC5wb3NpdGlvbi5zZXQoc3RlcC54LCBzdGVwLnksIHN0ZXAueik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYW5pbWF0ZSBzdGVwIGZvciBUaHJlZS5KUyBtYXRlcmlhbCBjb2xvclxuICAgICAqIEBwYXJhbSBzdGVwXG4gICAgICovXG4gICAgYW5pbWF0ZUNvbG9yU3RlcChzdGVwKSB7XG4gICAgICAgIHN0ZXAuYW5pbWF0aW9uLnRhcmdldC5tYXRlcmlhbC5jb2xvci5zZXRSR0Ioc3RlcC5yLzI1NSwgc3RlcC5nLzI1NSwgc3RlcC5iLzI1NSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYW5pbWF0ZSByZW5kZXIgaG9va1xuICAgICAqIEBwYXJhbSB0aW1lXG4gICAgICogQHBhcmFtIHNjZW5lXG4gICAgICovXG4gICAgb25SZW5kZXIoc2NlbmUsIHRpbWUpIHtcbiAgICAgICAgdmFyIHJ1bm5pbmcgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLmFuaW1hdGlvbnMubGVuZ3RoOyBjKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbnNbY10uYW5pbWF0aW9uLmFuaW1hdGluZykge1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcucHVzaCh0aGlzLmFuaW1hdGlvbnNbY10pO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgdGhpcy5hbmltYXRpb25zW2NdLmFuaW1hdGlvbi5zdGVwLmxlbmd0aDsgZCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1tjXS5hbmltYXRpb24uc3RlcFtkXS5hcHBseSh0aGlzLCBbdGhpcy5hbmltYXRpb25zW2NdXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IHJ1bm5pbmc7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQge1xuICAgIC8qKlxuICAgICAqIHR1cm4gZGVjaW1hbCBjb2xvciB0byBSR0JcbiAgICAgKiBAcGFyYW0gZGVjXG4gICAgICogQHJldHVybnMge3tyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyfX1cbiAgICAgKi9cbiAgICBkZWNUb1JHQihkZWMpIHtcbiAgICAgICAgdmFyIHIgPSAoZGVjID4+IDE2KSAmIDB4ZmY7XG4gICAgICAgIHZhciBnID0gKGRlYyA+PiA4KSAgJiAweGZmO1xuICAgICAgICB2YXIgYiA9IGRlYyAmIDB4ZmY7XG4gICAgICAgIHJldHVybiB7IHI6IHIsIGc6IGcsIGI6IGIgfTtcbiAgICB9LFxuXG4gICAgUkdCVG9EZWMocmdiKSB7XG4gICAgICAgIHJldHVybiByZ2IuciA8PCAxNiArIHJnYi5nIDw8IDE2ICsgcmdiLmI7XG4gICAgfVxufVxuIl19"}